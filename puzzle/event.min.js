!function(){var t=!1;this.Class=function(){},Class.extend=function(e){var i,s,n,r,o=this.prototype;for(s in t=!0,i=new this,t=!1,e)i[s]="function"==typeof e[s]&&"function"==typeof o[s]?function(t,e){return function(){return n=this._super,this._super=o[t],r=e.apply(this,arguments),this._super=n,r}}(s,e[s]):e[s];function h(e){if(!(this instanceof arguments.callee))return new arguments.callee(arguments);!t&&this.init&&this.init.apply(this,e&&e.callee?e:arguments)}return h.prototype=i,h.constructor=h,h.extend=arguments.callee,h}}(),function(t,e,i){"use strict";var s,n,r,o=Object.prototype.toString,h="function",a="string",c="object",u=!1,l=[],f=!1,p=t.G_vmlCanvasManager,v=/webkit|msie/i.exec(t.navigator.userAgent),d=navigator.userAgent,m=d.match(/android/i),g=d.match(/iphone|ipad|ipod/i),w=d.match(/Windows Phone/i)||d.match(/iemobile/i),y=/^([#]?)([a-z][\w\-]*)$/,_=["","LEFT","CENTER","RIGHT"],x=[],C=null,k=null,T=!1,b="Cevent"+(new Date).getTime(),z=0,P={},E=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e,i){t.setTimeout(e,1e3/60)},S=function(t,e){return o.call(t).slice(8,-1).toLowerCase()==e},X=function(t,e){var i,s=0;if(S(t,"array"))for(;(i=t[s++])&&!1!==e(i,s););},Y=function(t,e){var i=L(t,e);return i>=0?(t.splice(i,1),e):null},A={click:"touchstart",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},I=function(t){return document.getElementById(t)},D=document.addEventListener?function(t,e,i){t&&(t="string"==typeof t?I(t):t,i=function(t,e){var i=A[e];return i?function(e){var n=e.type===i;s=K.isTouchDevice=n,!n&&(m||g||w)||t.call(this,e)}:t}(i,e),A[e]&&t.addEventListener(A[e],i,!0),t.addEventListener(e,i,!0))}:function(e,i,s){e&&(e="string"==typeof e?I(e):e).attachEvent("on"+i,(function(e){return e=function(e){return(e=e||t.event).preventDefault||(e.preventDefault=function(){this.returnValue=!1}),e.stopPropagation||(e.stopPropagation=function(){this.cancelBubble=!0}),e}(e),s.call(e.target||e.srcElement,e)}))},L=[].indexOf?function(t,e){return t.indexOf(e)}:function(t,e){for(var i=0,s=t.length;i<s;i++)if(e===t[i])return i;return-1},H=function(t,e,i){var s,n=t[b];return n||(n=t[b]=++z),(s=P[n])||(s=P[n]={}),e&&undefined!==i&&(s[e]=i),e?s[e]:s},O=function(t,e,i){var s=H(t);X(e.split(" "),(function(t){(s[t]=s[t]||[]).push(i)}))},M=function(t,e,i,s){var n,r=0,o=!0;for(i.ctx.save(),i.ctx.scale(i.__zoom,i.__zoom);n=e[r++];)!1===n.call(t,i,s)&&(o=!1);return i.ctx.restore(),o||s.preventDefault(),o},q=function(t,e,i,s){var n=H(t,e),r=H(s.cv,e);n&&n.length&&x.push(t,n),r&&r.length&&x.push(t,r)},F=function(t,e){var i,s;for(t.clear(),i=0,s=x.length;i<s;i+=2)M(x[i],x[i+1],t,e);x=[],t.redraw()},N=function(e,i){e.preventDefault(),e=e.touches?e.touches[0]:e;var s,n=i._shapes,r=n.length;for(i.x=((e&&e.pageX-i._pos.x+1||t.event.offsetX+1)-1)/i.__zoom||0,i.y=((e&&e.pageY-i._pos.y+1||t.event.offsetY+1)-1)/i.__zoom||0;s=n[--r];)if(s.hitTest(i))return s},G=function(e,i){return function(s){s.preventDefault(),s=s.touches?s.touches[0]:s,e.lastX=e.x,e.lastY=e.y,i=e._curHover;var n=((s&&s.pageX-e._pos.x+1||t.event.offsetX+1)-1)/e.__zoom||0,r=((s&&s.pageY-e._pos.y+1||t.event.offsetY+1)-1)/e.__zoom||0;if(!(!f&&Math.abs(n-e.x)<2&&Math.abs(r-e.y)<2)){if(e.x=n,e.y=r,f=!0,!e._clicked&&u){var o=N(s,e);o?(i!==o&&(q(o,"mouseover",0,e),i&&q(i,"mouseout",0,e)),e._curHover=i=o):i&&(q(i,"mouseout",0,e),e._curHover=i=null)}i&&q(i,"mousemove",0,e),x.length&&F(e,s)}}},R=function(t){return function(e){u||(t._curHover=N(e,t)),t._curHover;var i=t._curHover,s=_[e.which||e.button];t._clicked=!0,C=t.cv,t[s]=!0,i?(q(i,"mousedown",0,t),i!==t.focused&&(q(i,"focus",0,t),t.focused&&q(t.focused,"blur",0,t))):t.focused&&(q(t.focused,"blur",0,t),t.focused=null),t.focused=i||null,x.length&&F(t,e),t[s]=!1}},B=function(t){return function(e){t._clicked=!1,t._curHover&&(q(t._curHover,"mouseup",0,t),!f&&s&&(q(t._curHover,"tap",0,t),t.lastClick&&e.timeStamp-t.lastClick<300&&q(t._curHover,"dblclick",0,t),t.lastClick=e.timeStamp)),f=!1,x.length&&F(t,e)}},W=(r={specialKeys:{27:"esc",9:"tab",32:"space",13:"return",8:"backspace",145:"scroll",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"del",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",109:"-",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",191:"/",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",110:".",111:"/",187:"+",189:"-"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"}},function(t,e){var i=H(e.cv,t,{}),s=H(i);return function(i){if(C===e.cv||e.__globalkeyevents){n="keydown"==t?i.keyCode:n;var o,h=r.specialKeys[n]||String.fromCharCode(n||i.charCode).toLowerCase(),a="";if(i.altKey&&(a+="alt+"),(i.ctrlKey||i.metaKey)&&(a+="ctrl+"),i.shiftKey&&(a+="shift+"),o=s[a+h]||s[a+r.shiftNums[h]]||"shift+"===a&&s[r.shiftNums[h]]||s.any){var c=M(e,o,e,i);return e.play||e.redraw(),c}}}}),K=function(i,s){if((i=S(i,a)?e.getElementById(i):i).getContext||t.G_vmlCanvasManager)return new K.fn.init(i,s);throw Error("Your browser sucks")};K.forse_redraw=function(){var t,e=l.length;for(t=0;t<e;t++)l[t].redraw()},K.fn=K.prototype={init:function(i,s){var n;this.cv=i,!i.getContext&&t.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(i),this.ctx=i.getContext("2d"),this.width=i.width,this.height=i.height,this.__zoom=1,this.x=0,this.y=0,this.cv[b]?(this._shapes=H(i,"shapes"),this._last=s):(l.push(this),this._shapes=H(i,"shapes",[]),this.__cache=H(i,"cache",document.createElement("canvas")),this._last=null,t.G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.__cache),this.__cachectx=this.__cache&&this.__cache.getContext("2d"),this.calcCanvasPosition(),D(i,"mousemove",G(this),!1),D(i,"dblclick",(n=this,function(t){n._curHover&&q(n._curHover,"dblclick",0,n),x.length&&F(n,t)}),!1),D(i,"click",function(t){return function(e){t._curHover&&q(t._curHover,"click",0,t),x.length&&F(t,e)}}(this),!1),D(i,"mouseup",B(this),!1),D(i,"mousedown",R(this),!1),D(e,"keydown",W("keydown",this),!1),D(e,"keyup",W("keyup",this),!1),v||D(e,"keypress",W("keypress",this),!1),"onselectstart"in i&&(i.onselectstart=function(){return!1},i.onmousedown=function(){return!1}))},updateCache:function(){this.__cache&&(this.__cache.width=this.cv.width,this.__cache.height=this.cv.height,Y(this._shapes,k),this.draw(),this._shapes.push(k),this.__cachectx.drawImage(this.cv,0,0))},calcCanvasPosition:function(){return this._pos=function(t){var e=0,i=0;if(t.offsetParent)do{e+=t.offsetLeft,i+=t.offsetTop}while(t=t.offsetParent);return{x:e,y:i}}(this.cv),this},get:function(t){return t=t<0?this._shapes.length+t:t,this._shapes[t]||this._shapes},getAll:function(t){var e,i,s=[],n=y.exec(t);return"*"===t?s=this._shapes.slice(0):n&&(e=n[1],i=n[2],X(this._shapes,(function(t){t[e]===i&&s.push(t)}))),s},remove:function(t){return function(t,e){if(t){var i=t[b];i&&P[i]&&(e?delete P[i][e]:delete P[i])}}(Y(this._shapes,t)),this.redraw()},addId:function(t){var e=y.exec(t),i=this._last;return e&&!e[1]&&i&&(i.length?X(i,(function(e){e["#"]=t})):i["#"]=t),this},removeId:function(){var t=this._last;return t&&!t.length?t["#"]="":X(t,(function(t){t["#"]=""})),this},find:function(t){var e=this.getAll(t);return K(this.cv,1==e.length?e[0]:e)},attr:function(t,e){var i=this._last;return i&&i.attr?i.attr(t,e):X(i,(function(i){i.attr(t,e)})),this},rotate:function(t){return this.attr({rotation:t})},translate:function(t,e){return this.attr({tx:t,ty:e})},scale:function(t,e){return this.attr({scaleX:t,scaleY:e})},skewX:function(t){return this.attr({skewX:t})},skewY:function(t){return this.attr({skewY:t})},zoomTo:function(t){return S(t,"number")&&(this.__zoom=t),this},zoomIn:function(){return this.zoomTo(this.__zoom+.1)},zoomOut:function(){return this.zoomTo(this.__zoom-.1)},setGlobalKeyEvents:function(t){return this.__globalkeyevents=!!t,this},bind:function(t,e,i){var s,n=i||this._last;if(u||-1=="mouseover mouseout".indexOf(t)||(u=!0),S(t,a)&&S(e,c))for(s in e)this[s](t,e[s]);else if(S(t,c))for(s in t)this[s](t[s]);else n&&!n.length?O(n,t,e):X(n,(function(i){O(i,t,e)}));return this},beforeDraw:function(t){return S(t,h)&&(this.__beforeDraw=t),this},afterDraw:function(t){return S(t,h)&&(this.__afterDraw=t),this},clear:function(t,e,i,s){return t=t||0,e=e||0,i=i||this.cv.width,s=s||this.cv.height,this.ctx.clearRect(t,e,i,s),this},draw:function(){var t,e=0,i=this._shapes;if(this.ctx.save(),K.__zoom=this.__zoom,this.__beforeDraw&&this.__beforeDraw.call(this,this),!p&&this.__cache&&T&&!this.play&&k)this.ctx.drawImage(this.__cache,0,0),k.draw(this.ctx);else for(;t=i[e++];)t.draw(this.ctx);return this.__afterDraw&&this.__afterDraw.call(this,this),K.__zoom=1,this.ctx.restore(),this},redraw:function(){return this.clear().draw()},loop:function(t){var e,i=this,s=H(this.cv);return S(t,h)&&(s.loop=t),t=s.loop,e=this.play=++z,function(){e===i.play&&(E(arguments.callee),i.redraw(),t&&(i.ctx.save(),t.call(i,i),i.ctx.restore()),i.frameCount+=1)}(),this},frameCount:0,stop:function(){return delete this.play,this}},K.fn.init.prototype=K.prototype,K.addEventListener=D,X("mousemove mouseover mouseout mousedown mouseup click dblclick focus blur tap".split(" "),(function(t){K.fn[t]=function(e,i){var s;return S(i,h)&&(e=function(t,e){var i=y.exec(t);return function(s,n){(i&&this[i[1]]===i[2]||"*"===t)&&e.call(this,s,n)}}(e,i),s=this.cv),this.bind(t,e,s)}})),X("keydown keypress keyup".split(" "),(function(t){K.fn[t]=function(e,i){return!i&&S(e,h)&&(i=e,e="any"),e=(e+"").toLowerCase(),this.bind(e,i,H(this.cv,t))}})),v&&(K.fn.keypress=K.fn.keydown),K.fn.drag=function(t){var e,i,n,r,o,h=[],c="Cevent-drag"+b,u=this._last;if(S(t,a)&&(o=t,t=arguments[1]),t&&(e=t.start,i=t.move,n=t.end,r=t.afterMove),o)return this.mousedown(o,l).mouseup(o,v).mousemove(o,f);u&&!u.length&&(u=[u]),X(u,(function(t){H(t,c)||(H(t,c,!0),h.push(t))}));K(this.cv,h).mousedown(l).mouseup(v).mousemove(f);function l(t,e){(t.LEFT||s)&&(k=this,t.play||p||T||t.updateCache())}function f(t,s){if(this===k){if(!T){if(e&&!1===e.call(this,t,s))return k=T=null;T=!0}i&&i.call(this,t,s),this.rmove(t.x-t.lastX,t.y-t.lastY),r&&r.call(this,t,s)}}function v(t,e){this===k&&(k=T=null,n&&n.call(this,t,e))}return this},K.registre=K.register=function(t,e){this[(t=t.toLowerCase()).charAt(0).toUpperCase()+t.substring(1)]=e,this.prototype[t]=function(){var i=e.apply(this,arguments);return i[""]=t,this._shapes.push(i),this._last=i,this}},D(e,"mousedown",(function(t){var e=t.target||t.srcElement;(e="OBJECT"==e.nodeName?e.parentNode:e)[b]||(C=e)}),!1),K.isTouchDevice=s,t.Cevent=K}(this,document),function(t,e){"use strict";var i,s,n,r,o=Math,h=o.PI,a=2*h,c=h/180,u=o.sqrt,l=o.pow,f=o.cos,p=o.sin,v=o.round,d=o.abs,m=o.acos,g=o.atan2,w=Object.prototype.hasOwnProperty,y=Array.prototype.slice,_={tx:0,ty:0,scaleX:1,scaleY:1,skewX:0,skewY:0,fill:"#000",stroke:"",lineWidth:1,lineJoin:"miter",lineCap:"butt",alpha:1,rotation:0,composite:"source-over",shadowColor:"rgba(0, 0, 0, 0.0)",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,fontStyle:"normal",fontWeight:"normal",fontSize:10,fontFamily:"Arial"},x=document.createElement("canvas"),C=x.getContext&&x.getContext("2d"),k=function(t,e){return u(l(t.x-e.x,2)+l(t.y-e.y,2))},T=function(t,e,i){return{x:t*f(i*=c)-e*p(i),y:t*p(i)+e*f(i)}},b=function(t,e){var i;for(i in e)w.call(e,i)&&(t[i]=e[i])},z=Class.extend({init:function(t,e){this.x=t||0,this.y=e||0,b(this,_)},position:function(){var t=T(this.x*this.scaleX,this.y*this.scaleY,this.rotation);return{x:t.x+this.tx,y:t.y+this.ty}},rmove:function(t,e){this.tx+=t,this.ty+=e},attr:function(t,e){var i;if("string"==typeof t)this[t]=e;else for(i in t)this[i]=t[i];return this},applyStyle:function(t){var e=this.shadowBlur,i=this.shadowOffsetX,s=this.shadowOffsetY;t.fillStyle=this.fill,t.globalAlpha=this.alpha,t.globalCompositeOperation=this.composite,this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.lineWidth),(i||s||e)&&(t.shadowColor=this.shadowColor,t.shadowOffsetX=i,t.shadowOffsetY=s,t.shadowBlur=e)},setTransform:function(e){var i=t.__zoom,s=this.scaleX*i,n=this.scaleY*i,r=this.skewX*i,o=this.skewY*i,h=this.rotation*c,a=p(h),u=f(h),l=this.tx*i,v=this.ty*i,d=u*s-a*o,m=u*r-a*n,g=a*s+u*o,w=a*r+u*n;e.setTransform(d,g,m,w,l,v)},draw:function(t){throw new Error("El mtodo draw no se ha implementado")},fill_or_stroke:function(t){this.fill&&t.fill(),this.stroke&&t.stroke()},hitTest:function(t){if(C&&C.isPointInPath)return this.draw(C),C.setTransform(1,0,0,1,0,0),C.isPointInPath(t.x,t.y);throw Error("Mtodo isPointInPath no soportado: Necesita FlashCanvasPro")}}),P=z.extend({init:function(t,e,i,s,n){this.r=n||0,this.w=i||5,this.h=s||i,this._super(t,e)},draw:function(e){var i=this.x,s=this.y,n=this.w,r=this.h;this.applyStyle(e),this.setTransform(e),e.beginPath(),this.r?t.setContext(e).polygon(i,s,i+n,s,i+n,s+r,i,s+r,this.r):e.rect(i,s,v(n),v(r)),e.closePath(),this.fill&&e.fill(),this.stroke&&e.stroke()},hitTest:function(t){if(this.skewX||this.skewY||this.r)return this._super(t);var e=this.position(),i=T(t.x-e.x,t.y-e.y,-this.rotation);return i.x>=0&&i.x<=this.w*this.scaleX&&i.y>=0&&i.y<=this.h*this.scaleY}}),E=P.extend({init:function(t,e,i){this.setText(i),this._super(t,e,this.w,this.h)},applyStyle:function(t){t.font=this.fontStyle+" "+this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.h=this.fontSize,this.w=t.measureText(this.text).width,this._super(t)},setText:function(t){this.text=t+""},draw:function(t){this.applyStyle(t),this.setTransform(t),this.fill&&t.fillText(this.text,this.x,this.y+this.h),this.stroke&&t.strokeText(this.text,this.x,this.y+this.h)},hitTest:function(t){return this.skewX||this.skewY&&C&&C.isPointInPath?(this.setTransform(C),C.beginPath(),C.rect(this.x,this.y,this.w,this.h),C.closePath(),C.isPointInPath(t.x,t.y)):this._super(t)}}),S={},X=P.extend({init:function(t,e,i){this.setImg(i),this._super(t,e,this.img.width,this.img.height)},setImg:function(e){if(S[e])return this.img=S[e],void(this.src=this.img.src);"IMG"==e.nodeName?this.img=e:(e+="",this.img=S[e]=new Image,this.img.src=e),this.img.onload=function(){t.forse_redraw()},this.src=this.img.src},draw:function(t){var e=this.x,i=this.y;this.w=this.img.width,this.h=this.img.height,this.applyStyle(t),this.setTransform(t),t===C?(t.beginPath(),t.rect(e,i,v(this.w),v(this.h)),t.closePath()):t.drawImage(this.img,e,i)}}),Y=P.extend({draw:function(t){var e=this.x,i=this.y,s=this.w,n=this.h,r=.5522847498307933,o=r*s,h=r*n;this.applyStyle(t),this.setTransform(t),t.beginPath(),t.moveTo(e+s,i),t.bezierCurveTo(e+s,i-h,e+o,i-n,e,i-n),t.bezierCurveTo(e-o,i-n,e-s,i-h,e-s,i),t.bezierCurveTo(e-s,i+h,e-o,i+n,e,i+n),t.bezierCurveTo(e+o,i+n,e+s,i+h,e+s,i),t.closePath(),this.fill&&t.fill(),this.stroke&&t.stroke()},hitTest:z.prototype.hitTest}),A=z.extend({init:function(t,e,i,s,n,r){this.clockwise=r,this.endAngle=n,this.startAngle=s,this.r=i,this._super(t,e)},draw:function(t){var e=this.x,i=this.y;this.applyStyle(t),this.setTransform(t),t.beginPath(),t.arc(e,i,v(this.r),this.startAngle||2*h,this.endAngle||0,!!this.clockwise),t.lineTo(e,i),t.closePath(),this.fill&&t.fill(),this.stroke&&t.stroke()}}),I=z.extend({init:function(t,e,i){this.r=i||5,this._super(t,e)},draw:function(t){var e=this.x,i=this.y;this.applyStyle(t),this.setTransform(t),t.beginPath(),t.arc(e,i,v(this.r),0,2*h,!0),t.closePath(),this.fill&&t.fill(),this.stroke&&t.stroke()},hitTest:function(t){if(this.skewX||this.skewY||this.scaleX!==this.scaleY)return this._super(t);var e=!!this.stroke&&this.lineWidth,i=this.position();return k(t,i)<=(this.r+e)*this.scaleX}}),D=z.extend({init:function(t,e,i,s){this.x2=i,this.y2=s,this._super(t,e),this.stroke="#000"},rmove:function(t,e){this.x+=t,this.y+=e,this.x2+=t,this.y2+=e},applyStyle:function(t){t.lineJoin=this.lineJoin,t.lineCap=this.lineCap,this._super(t)},draw:function(t){this.applyStyle(t),this.setTransform(t),t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x2,this.y2),t.stroke()},hitTest:function(t){return function(t,e,i,s,n){var r,o=i-t,h=s-e;if(0!==o||0!==h)return r=((n.x-t)*o+(n.y-e)*h)/(o*o+h*h),k(r<0?{x:t,y:e}:r>1?{x:i,y:i}:{x:t+r*o,y:e+r*h},n)}(this.x,this.y,this.x2,this.y2,t)<=this.lineWidth+2}}),L=null,H=null,O=!1,M=/[MmLlZzHhVvCcQqSsTtAa]\s*([\-+]?(?:\d+[.]?\d*|[.]\d+)(?:[Ee][\-+]?\d+)?[,\s]*)*/g,q=/[\-+]?(?:\d+[.]?\d*|[.]\d+)(?:[Ee][\-+]?\d+)?/g,F=function(t,e,i,s){var n,r,o=(t*i+e*s)/(u(t*t+e*e)*u(i*i+s*s));return o>1?o=1:o<-1&&(o=-1),n=d(m(o)),(r=t*s-e*i)===d(r)?n:-n},N=function(t,e,i){return[t*f(i)-e*p(i),e*f(i)+t*p(i)]},G=function(t,e,i){O&&t.ctx.moveTo(e,i)},R=function(t,e){s=t,n=e,L=null,H=null,O=!1},B=function(){if(s===i)throw new Error("No current point; can't use relative coordinates")},W=function(t,e,i,s){if(e!==(i?t.length%i:t.length)||t.length<s)throw new Error("wrong number of arguments")},K=function(t,e){var i,s=arguments.length;for(W(arguments,0,2,2),G(this,t,e),this.ctx.lineTo(t,e),i=2;i<s;i+=2)this.ctx.lineTo(t=arguments[i],e=arguments[i+1]);return R(t,e),this},J=function(t,e){var i,r=s,o=n,h=arguments.length;for(W(arguments,0,2,2),B(),i=0;i<h;i+=2)this.ctx.lineTo(r+=arguments[i],o+=arguments[i+1]);return R(r,o),this},j=function(){return this.ctx.closePath(),R(this,r),this},V=function(t,e,i,r,o,h,l){if(!t||!e)return K.call(this,h,l);r=!!r,o=!!o,B();var v,m,g,w,y,_,x,C,k=s,T=n,b=h,z=l,P=i*c,E=p(P),S=f(P),X=(k-b)/2,Y=(T-z)/2,A=S*X+E*Y,I=-E*X+S*Y;if((v=A*A/((t=d(t))*t)+I*I/((e=d(e))*e))>1)t*=u(v),e*=u(v),m=g=0;else{var D=t*t,L=e*e,H=D*(I*I)+L*(A*A);H=u(D*L/H-1),r===o&&(H=-H),m=H*t*I/e,g=-H*e*A/t}return w=S*(m-E)*(g+(k+b)/2),y=E*(m+S)*(g+(T+z)/2),_=F(1,0,X=(A-m)/t,Y=(I-g)/e),C=F(X,Y,(-A-m)/t,(-I-g)/e),o&&C<0?C+=a:!o&&C>0&&(C-=a),x=_+C,this.ellipse(w,y,t,e,P,_,x,!o),this},Q=z.extend({init:function(t){this.svgpath=function(t){var e,i,s,n,r,o=t.match(M),h=[];if(!o)throw new Error("Bad path: "+t);for(n=0;e=o[n];n++){for((s=[]).cmd=e.charAt(0),i=e.match(q)||[],r=0;r<i.length;r++)s[r]=+i[r];h.push(s)}return h}(t),this._super(0,0),"m"==this.svgpath[0].cmd.toLowerCase()&&(this.x=this.svgpath[0][0],this.y=this.svgpath[0][1])},draw:function(e){var i,s,n=this.svgpath;for(this.applyStyle(e),this.setTransform(e),e.beginPath(),t.setContext(e),i=0,s=n.length;i<s;i++)t[n[i].cmd].apply(t,n[i]);this.fill&&e.fill(),this.stroke&&e.stroke()}});b(t,{distance:k,__zoom:1,Shape:z,setContext:function(t){return this.ctx=t,R(0,0),t.beginPath(),this},polygon:function(){var t,e=arguments,i=e.length;if(i<6)throw new Error("not enough arguments");if(i%2==0)for(this.ctx.moveTo(e[0],e[1]),t=2;t<i;t+=2)this.ctx.lineTo(e[t],e[t+1]);else{var s,n,r=e[i-1],o=(i-1)/2,h=(e[2*o-2]+e[0])/2,a=(e[2*o-1]+e[1])/2;for(this.ctx.moveTo(h,a),t=0;t<o-1;t++)this.ctx.arcTo(s=e[2*t],n=e[2*t+1],e[2*t+2],e[2*t+3],r,h,a),h=s,a=n;this.ctx.arcTo(e[2*o-2],e[2*o-1],e[0],e[1],r,h,a)}return this},ellipse:function(t,e,s,n,r,o,h,c){r=r||0,h=h===i?a:h;var u=N(s*f(o=o||0),n*p(o),r),l=t+u[0],v=e+u[1],d=N(s*f(h),n*p(h),r),m=t+d[0],g=e+d[1];return G(this,l,v),this.ctx.translate(t,e),this.ctx.rotate(r),this.ctx.scale(s/n,1),this.ctx.arc(0,0,n,o,h,!!c),this.ctx.scale(n/s,1),this.ctx.rotate(-r),this.ctx.translate(-t,-e),R(m,g),this},M:function(t,e){return this.ctx.moveTo(t,e),R(t,e),r=t,e,arguments.length>2&&K.apply(this,y.call(arguments,2)),this},m:function(t,e){return O&&(s=n=0),B(),t+=s,e+=n,this.ctx.moveTo(t,e),R(t,e),r=t,e,arguments.length>2&&J.apply(this,y.call(arguments,2)),this},L:K,l:J,H:function(t){var e,i=arguments.length;for(B(),e=0;e<i;e++)K.call(this,arguments[e],n);return this},h:function(t){var e,i=arguments.length;for(e=0;e<i;e++)J.call(this,arguments[e],0);return this},V:function(t){var e,i=arguments.length;for(B(),e=0;e<i;e++)K.call(this,s,arguments[e]);return this},v:function(t){var e,i=arguments.length;for(e=0;e<i;e++)J.call(this,0,arguments[e]);return this},C:function(t,e,i,s,n,r){var o,h=arguments,a=arguments.length;for(W(h,0,6,6),G(this,t,i),this.ctx.bezierCurveTo(t,e,i,s,n,r),o=6;o<a;o+=6)this.ctx.bezierCurveTo(h[o],h[o+1],i=h[o+2],s=h[o+3],n=h[o+4],r=h[o+5]);return R(n,r),L=[i,s],this},c:function(t,e,i,r,o,h){var a,c=arguments,u=c.length,l=s,f=n;for(W(c,0,6,6),B(),a=0;a<u;a+=6)this.ctx.bezierCurveTo(l+c[a],f+c[a+1],i=l+c[a+2],r=f+c[a+3],l+=c[a+4],f+=c[a+5]);return R(l,f),L=[i,r],this},S:function(){if(!L)throw new Error("Last command was not a cubic bezier");var t,e,i,r,o,h,a,c=arguments,u=c.length,l=s,f=n,p=L[0],v=L[1];for(W(arguments,0,4,4),B(),t=0;t<u;t+=4)e=l+(l-p),r=f+(f-v),i=c[t],o=c[t+1],h=c[t+2],a=c[t+3],this.ctx.bezierCurveTo(e,r,i,o,h,a),l=h,f=a,p=i,v=o;return R(l,f),L=[p,v],this},s:function(){if(!L)throw new Error("Last command was not a cubic bezier");var t,e,i,r,o,h,a,c=arguments,u=c.length,l=s,f=n,p=L[0],v=L[1];for(W(arguments,0,4,4),B(),t=0;t<u;t+=4)e=l+(l-p),r=f+(f-v),i=l+c[t],o=f+c[t+1],h=l+c[t+2],a=f+c[t+3],this.ctx.bezierCurveTo(e,r,i,o,h,a),l=h,f=a,p=i,v=o;return R(l,f),L=[p,v],this},Q:function(t,e,i,s){var n,r=arguments,o=r.length;for(W(arguments,0,4,4),G(this,t,e),this.ctx.quadraticCurveTo(t,e,i,s),n=4;n<o;n+=4)this.ctx.quadraticCurveTo(t=r[n],e=r[n+1],i=r[n+2],s=r[n+3]);return R(i,s),H=[t,e],this},q:function(t,e,i,r){var o,h=arguments,a=h.length,c=s,u=n;for(W(arguments,0,4,4),B(),o=0;o<a;o+=4)this.ctx.quadraticCurveTo(t=c+h[o],e=u+h[o+1],c+=h[o+2],u+=h[o+3]);return R(c,u),H=[t,e],this},T:function(){if(!H)throw new Error("Last command was not a cubic bezier");var t,e,i,r,o,h=arguments.length,a=s,c=n,u=H[0],l=H[1];for(W(arguments,0,2,2),B(),t=0;t<h;t+=2)e=a+(a-u),i=c+(c-l),r=arguments[t],o=arguments[t+1],this.ctx.quadraticCurveTo(e,i,r,o),a=r,c=o,u=e,l=i;return R(a,c),H=[u,l],this},t:function(){if(!H)throw new Error("Last command was not a cubic bezier");var t,e,i,r,o,h=arguments.length,a=s,c=n,u=H[0],l=H[1];for(W(arguments,0,2,2),B(),t=0;t<h;t+=2)e=a+(a-u),i=c+(c-l),r=a+arguments[t],o=c+arguments[t+1],this.ctx.quadraticCurveTo(e,i,r,o),a=r,c=o,u=e,l=i;return R(a,c),H=[u,l],this},A:V,a:function(t,e,i,r,o,h,a){return B(),V.call(this,t,e,i,r,o,h+s,a+n),this},Z:j,z:j}),function(){if(C&&(P(40,40,40,40,5).draw(C),!C.getImageData(79,60,1,1).data[3])){var t=CanvasRenderingContext2D.prototype.arcTo,e=function(t,e,i,s){return(t-i)*(t-i)+(e-s)*(e-s)};CanvasRenderingContext2D.prototype.arcTo=function(i,s,n,r,o,h,a){if(isNaN(h+a))return t.apply(this,arguments);var c,l,f,p,v,d,m,w,y,_,x,C,k,T,b,z;i==h&&s==a||i==n&&s==r||0==o?this.lineTo(i,s):0!=(c=(n-i)*(a-s)+(r-s)*(i-h))?(p=((l=e(h,a,i,s))+(f=e(i,s,n,r))-e(h,a,n,r))/(2*u(l*f)),l=u(l),_=i-(i-n)/(f=u(f))*(v=o*u(1-p*p)/(1-p)),x=s-(s-r)/f*v,b=g((y=s-(m=(s-a)/l)*v)-(T=y-(d=(i-h)/l)*o*((C=c<0)?1:-1)),(w=i-d*v)-(k=w+m*o*(C?1:-1))),z=g(x-T,_-k),this.lineTo(w,y),this.arc(k,T,o,b,z,C)):this.lineTo(i,s)}}}(),e.FlashCanvas&&(document.body.appendChild(x),FlashCanvas.initElement(x),C=x.getContext("2d"),x.style.display="none"),C&&(C.fill=C.stroke=function(){}),t.register("image",X),t.register("circle",I),t.register("arc",A),t.register("ellipse",Y),t.register("rect",P),t.register("text",E),t.register("line",D),t.register("path",Q)}(Cevent,this);